<!doctype html>
<html>
<head>
<link rel="icon" type="image/PetTag-icon" href="Images/Favicon.ico">	
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<title>Add a New Report</title>
  <style>
    body {
      margin: 0;
      font-family: Calibri, sans-serif;
      background-color: #f5f5f5;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
		flex-direction: column;
      margin: 0;
    }
	  
	.navbar {
  		position: fixed;
  		top: 0;
  		left: 0;
  		width: 100%;
  		background-color: #2EC4B6;
  		display: flex;
  		align-items: stretch;
  		justify-content: space-around;
  		z-index: 1000;
	}

    .navbar .logo {
      display: flex;
      align-items: center;
      font-size: 22px;
      font-weight: bold;
      color: white;
    }

	.navbar a {
  		display: flex;
  		align-items: center;
  		justify-content: center;
  		padding: 0 30px;
  		text-decoration: none;
  		color: white;
  		font-weight: bold;
  		transition: all 0.3s ease;
  		height: 100%;
	}

	.navbar a:hover {
  		background-color: #24A696;
	}
	  
    /* Konten dummy biar bisa discroll */
    .content {
      padding: auto;
		
    }

	.content-inside {
      background-color: white;
      padding: 20px 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      width: 400px;
    }
	  
    .form-container {
      background-color: white;
      padding: 20px 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      width: 400px;
		height: auto;
		margin: 0px 20px 20px 20px;
    }

    h2 {
      text-align: center;
      margin-bottom: 15px;
      font-size: 18px;
      color: #000;
    }

    label {
      display: block;
      margin-top: 12px;
      font-size: 14px;
      color: #000;
    }

    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }

    .form-row {
      	display: flex;
		flex-direction: column;
      	justify-content: space-between;
      	gap: 10px;
    }

    .form-row input {
      width: 100%;
    }

    button1 {
      width: 100%;
      padding: 10px;
      margin-top: 20px;
      background-color: #32D0C4;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 15px;
      cursor: pointer;
    }

    button1:hover {
      background-color: #2FAAA0;
    }
	  
    button2 {
      width: 100%;
      padding: 10px;
      margin-top: 20px;
      background-color: #FFFFFF;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 15px;
      cursor: pointer;
    }

    button2:hover {
      background-color: #E4E4E4;
    }
	  
	.content-main2 {
		display: flex;
		flex-direction: row;
		margin-top: 0px;
      	padding: 20px;
		align-items: flex-start;
	  }
	  
	.content-main1 {
		margin-top: 0px;
		display: flex;
		flex-direction: column;
		align-items: center;
		width: 100%;
		background: #D0D0D0;
	  }
	  
	  .navbar-background {
		  width: 100%;
		  height: auto;
		  background-image: url("Images/TrackerBG.png");
		  background-repeat: no-repeat;
		  margin-top: 100px;
		  background-size: cover;
	  }

	  .pet-card {
		  width: 300px;
		  border: 1px solid #ccc;
		  border-radius: 10px;
		  overflow: hidden;
		  text-align: center;
		  transition: 0.3s;
	  }
	  
	  .pet-photo {
		  aspect-ratio: 1 / 1;
		  overflow: hidden;
	  }
	  
	  .pet-photo img {
		  width: 100%;
		  height: 100%;
		  object-fit: cover;
	  }
	  
	  .pet-info h3{
		  color: grey;
		  font-size: 25px;
		  margin-bottom: 0px;
	  }
	  
	  .pet-info p{
		  color: white;
		  background-color:#8C1B1D;
		  border-radius: 5px;
		  font-weight: bold;
	  }
	  
	  .lost-info p{
		  color: grey;
		  font-weight: bold;
		  margin-right: 10px;
		  margin-left: 10px;
		  font-size: 18px;
		  text-align: left;
	  }
	  
	  .missing-pet-info {
		  background: #FFFF;
		  border-radius: 10px;
		  width: 900px;
		  margin: 20px;
		  display: flex;
		  flex-direction: row;
		  
	  }
	  .pet-info-table td{
		  color: grey;
		  font-weight: 500;
		  padding: 10px;
		  margin: 10px
	  }
	  
	 .pet-info-table th{
		  color: grey;
		 text-align: left;
	  }
	  
	  input::placeholder {
		  color: #C8C8C8;
	  }
	  
	  .button-social{
		  background-color: #FFDE59;
		  padding: 5px;
		  color: white;
		  text-shadow: 0px 0px 10px grey;
		  font-family: calibri;
		  border-radius: 5px;
		  box-shadow: 0px 3px 0 0 #9A873A;
		  text-align: center;
		  font-weight: bold;
	  }
	  
	  .button-social:hover{
		  box-shadow: 0px 5px 0 0 #9A873A;
		  transform: translateY(-3px);
	  }
	  
	  #imagePreview {
		  width: 100%;
		  height: 100%;
		  object-fit: cover;
	  }
  </style>
</head>
<body>
  <!-- Navigation bar -->
  <div class="navbar">
    <div class="logo"><img src="Images/Logo.png" width="232" height="70" alt=""/></div>
    <a href="Home.html"><img src="Images/HOME.png" alt="Home" width="200"></a>
	<a href="Reports.html"><img src="Images/REPORTS.png" alt="Reports" width="200"></a>
	<a href="Tracker.html"><img src="Images/TRACKER.png" alt="Tracker" width="200"></a>
	<a href="Reunited.html"><img src="Images/REUNITEDPETS.png" alt="Reunited" width="200"></a>	
  </div>

	<div class="content-main1" style="align-items: center; background-image: url(Images/PATTERN2.png); background-repeat: repeat; margin-top: 110px;  padding: 20px 0px 20px 0px">

		<div class="content-inside" style="width: 1000px; display: flex; flex-direction: row; background: #E5EBEC; box-shadow: 0px 0px 20px grey">
			<div style="padding: 20px 0px 0px 0px">
				<div class="pet-card">
					<div class="pet-photo" id="imagePreview">
						<!-- User inputted image will be showed here -->
					</div>
				</div>
				<div>
					<div class="button-social" style="margin: 20px 0px 0px 0px; width: 97%; font-size: 16px; cursor: pointer;">Submit</div>
				</div>
			</div>
			<div class="missing-pet-info" style="padding-bottom: 30px">
				<div class="lost-info" style="margin-left: 20px;">
					<table class="pet-info-table" width="620px" border="0" style="border-collapse: collapse; font-size: 18px;">
					  <tbody>
						<tr style="border-bottom: 1px solid #E5EBEC">

						</tr>
						<tr style="border-bottom: 1px solid #E5EBEC">
							<td width="282" style=""><input style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px" placeholder="Pet Name" id="petName"></td>
						</tr>
						<tr style="border-bottom: 1px solid #E5EBEC">
							<td width="282" style="">
								<select name="status" required="required" style="border: none; outline: none; padding: 5px 5px 5px 5px; font-size: 15px; color: grey; background-color: #EBEBEB; border-radius: 5px;" id="status">
									<option style="color: white; background-color:#8C1B1D; border-radius: 5px; font-weight: bold; padding-left: 5px; padding-right: 5px;" value="Lost">Lost</option>
        							<option style="color: white; background-color: darkorange; border-radius: 5px; font-weight: bold; padding-left: 5px; padding-right: 5px" value="Found">Found</option>
									
								</select>
							</td>
						</tr>
						<tr style="border-bottom: 1px solid #E5EBEC">
							<td width="282" style=""><input required="required" placeholder="Pet Type" style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px" id="petType"></td>
						</tr>
						<tr style="border-bottom: 1px solid #E5EBEC">
							<td width="282" style=""><input required="required" placeholder="Last Approximate Location" style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px" id="location"></td>
						</tr>
						<tr>
							<td width="282" style="border-bottom: 1px solid #E5EBEC"><input type="text" required="required" placeholder="Message from Owner" style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px" id="message"></td>
						</tr>
						<tr>
							<td width="282" style="border-bottom: 1px solid #E5EBEC"><input type="text" required="required" placeholder="Email" style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px" id="email"></td>
						</tr>
						<tr>
							<td width="282" style="border-bottom: 1px solid #E5EBEC"><input type="text" placeholder="Phone Number" style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px" id="phone"></td>
						</tr>
						 <tr>
							<td width="282" style="border-bottom: 1px solid #E5EBEC"><input type="text" placeholder="Owner/Founder Location" style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px" id="oflocation"></td>
						</tr>
						<tr>
						</tr>
						<tr>
							<td width="282" style="border-bottom: 1px solid #E5EBEC"><input style="border: none; outline: none; padding: 10px 0px 0px 0px; font-size: 15px; color: #C8C8C8" type="file" id="imageInput" accept="image/*"></td>
						</tr>
					  </tbody>
					</table>
           		</div>
			</div>
		</div>
	</div>
	
	<!-- Footer -->
	<div class="content-main1" style="background-color: white">
		<div style="display: flex; flex-direction: row; justify-content: center">
			<div style="width: 500px; display: flex; flex-direction: column; align-items: center" >
				<h1 style="font-family: calibri; font-weight: 100; text-align: center">Contact Our Helpers</h1>
				<div style="width: 250px">
					<li type="none"><img src="Images/phonesilhouette.png" alt="Telephone" width="15px"> +1-776-8800-7744</li>
					<li type="none"><img src="Images/phonesilhouette.png" alt="Telephone" width="15px"> +62-877-6677-0005</li>
					<li type="none"><img src="Images/phonesilhouette.png" alt="Telephone" width="15px"> +62-1123-4455-6677</li>
			  </div>
			</div>
			<div style="width: 500px; display: flex; flex-direction: column; align-items: center">
				<h1 style="font-family: calibri; font-weight: 100; text-align: center">Visit Our Social Media</h1>
				<div style="width: 250px">
				  <li type="none"><img src="Images/Instagram.png" alt="Instagram" width="15px"> @pettag</li>
					<li type="none"><img src="Images/Facebook.png" alt="Facebook" width="15px"> @pettaghelper</li>
					<li type="none"><img src="Images/X.png" alt="X" width="15px"> @pettag</li>
			  </div>
			</div>
				<div style="width: 500px; display: flex; flex-direction: column; align-items: center">
				<h1 style="font-family: calibri; font-weight: 100; text-align: center">Seek for Veterinarians</h1>
				<div style="width: 250px">
				  <li type="none"><img src="Images/phonesilhouette.png" alt="Telephone" width="15px"> +62-851-7163-2227</li>
					<li type="none"><a href="https://sl1nk.com/Ud5SB" style="text-decoration: none; color: black;"><img src="Images/websitesilhouette.png" alt="Telephone" width="15px"> https://sl1nk.com/Ud5SB</a></li>
					<li type="none"><a href="https://dokterhewanbandung.com" style="text-decoration: none; color: black;"><img src="Images/websitesilhouette.png" alt="Telephone" width="15px"> https://dokterhewanbandung.com</a></li>
					</div>
			  </div>
		</div>
		<div>
			<p style="text-align:center; font-style:italic; color:#555; font-size: 65px; font-family: times new roman">"Connecting pets, reuniting hearts."</p>
		</div>
		
		<img src="Images/FOOTER.png" alt="Footer" width="100%">	
	</div>
	<script>
		const imageInput = document.getElementById('imageInput');
		const imagePreview = document.getElementById('imagePreview');

		imageInput.addEventListener('change', function(event) {
			const file = event.target.files[0]; // Get the selected file

			if (file) {
				const reader = new FileReader(); // Create a FileReader object

				reader.onload = function(e) {
					// Create an <img> element
					const img = document.createElement('img');
					img.src = e.target.result; // Set the image source to the data URL
					img.alt = "Selected Image"; // Add alt text for accessibility
					img.style.maxWidth = '100%'; // Optional: style the image to fit the div
					img.style.height = 'auto'; // Optional: maintain aspect ratio

					// Clear previous content and append the new image
					imagePreview.innerHTML = '';
					imagePreview.appendChild(img);
				};

				reader.readAsDataURL(file); // Read the image file as a data URL
			} else {
				imagePreview.innerHTML = ''; // Clear the preview if no file is selected
			}
		});	
	</script>
	
	<script>
		document.addEventListener("DOMContentLoaded", () => {
		  // --- Cari element tombol submit (mendukung id atau class) ---
		  let submitBtn = document.getElementById("submitBtn");
		  if (!submitBtn) submitBtn = document.querySelector(".button-social");
		  if (!submitBtn) {
			console.error("Submit button not found. Make sure there's id='submitBtn' or class='button-social'.");
			return;
		  }

		  // --- Element lain (sesuaikan kalau id di HTMLmu beda) ---
		  const imageInput = document.getElementById("imageInput");
		  const imagePreview = document.getElementById("imagePreview");
		  const petNameEl = document.getElementById("petName");
		  const petTypeEl = document.getElementById("petType");
		  const statusEl = document.getElementById("status");
		  const locationEl = document.getElementById("location");
		  const messageEl = document.getElementById("message");
		  const emailEl = document.getElementById("email");
		  const phoneEl = document.getElementById("phone");
		  const oflocationEl = document.getElementById("oflocation");

		  // Validasi keberadaan elemen penting
		  if (!imageInput || !imagePreview || !petNameEl || !petTypeEl || !statusEl || !locationEl || !messageEl || !emailEl || !oflocationEl) {
			console.warn("Some of the elements were not found. Make sure the inputs have id: imageInput, imagePreview, petName, petType, status, location, message, email, oflocation.");
			// kita tetap lanjut, tapi user akan dapat error jika klik submit
		  }

		  // --- Preview gambar saat user pilih file ---
		  if (imageInput && imagePreview) {
			imageInput.addEventListener("change", (e) => {
			  imagePreview.innerHTML = "";
			  const file = e.target.files && e.target.files[0];
			  if (!file) return;
			  const img = document.createElement("img");
			  img.src = URL.createObjectURL(file);
			  img.style.width = "250px";
			  img.style.height = "250px";
			  img.style.objectFit = "cover";
			  img.style.borderRadius = "8px";
			  imagePreview.appendChild(img);
			});
		  }

		  // --- Handler klik untuk div submit ---
		  submitBtn.addEventListener("click", async (ev) => {
			try {
			  // Ambil nilai (cek null-safe)
			  const petName = petNameEl ? petNameEl.value.trim() : "";
			  const petType = petTypeEl ? petTypeEl.value.trim() : "";
			  const status = statusEl ? statusEl.value : "";
			  const location = locationEl ? locationEl.value.trim() : "";
			  const message = messageEl ? messageEl.value.trim() : "";
			  const email = emailEl ? emailEl.value.trim() : "";
			  const phone = phoneEl ? phoneEl.value.trim() : "";
			  const oflocation = oflocationEl ? oflocationEl.value.trim() : "";
			  const file = imageInput && imageInput.files && imageInput.files[0] ? imageInput.files[0] : null;

			  // Validasi minimal
			  if (!petName || !petType || !status || !location || !message || !email || !file || !oflocation) {
				alert("Please fill all the questions and insert an image.");
				return;
			  }

			  // Baca file sebagai base64 (promise wrapper)
			  const readFileAsDataURL = (f) => new Promise((res, rej) => {
				const reader = new FileReader();
				reader.onload = () => res(reader.result);
				reader.onerror = () => rej(new Error("Failed to read file"));
				reader.readAsDataURL(f);
			  });

			  const imageBase64 = await readFileAsDataURL(file);

			  // Buat object post
			  const newPost = {
				petName, petType, status, location, message, email, phone, oflocation,
				image: imageBase64,
				date: Date.now()
			  };

			  // Simpan ke localStorage
			  const existing = JSON.parse(localStorage.getItem("petPosts")) || [];
			  existing.push(newPost);
			  localStorage.setItem("petPosts", JSON.stringify(existing));

			  // Opsional: beri feedback
			  alert("Post has been saved. Redirecting...");
			  // Redirect ke halaman reports
			  window.location.href = "Reports.html";
			} catch (err) {
			  console.error("Error while submitting:", err);
			  alert("Something wrong when processing files. Check console for details.");
			}
		  });
		});
	</script>
	
	<script>
		document.addEventListener("DOMContentLoaded", () => {
		  const temp = JSON.parse(localStorage.getItem("tempReport"));
		  if (!temp) return;

		  document.getElementById("petName").value = temp.petName || "";
		  document.getElementById("status").value = temp.status || "";
		  document.getElementById("oflocation").value = temp.oflocation || "";
		  document.getElementById("phone").value = temp.phone || "";
		  document.getElementById("email").value = temp.email || "";

		  // hapus data sementara setelah auto-isi
		  localStorage.removeItem("tempReport");
		});
	</script>
</body>
</html>
